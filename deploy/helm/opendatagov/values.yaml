# ===== OpenDataGov - Embedded Profile (Default) =====
# Resources: 1-2 vCPU, 2-4GB RAM
# Target: Edge computing, IoT gateways, development laptops
# Note: Minimal services for resource-constrained environments

# ─── Global Settings ─────────────────────────────────────
global:
  profile: embedded
  domain: opendatagov.local
  storageClass: standard

  # Image settings
  imageRegistry: ""
  imagePullSecrets: []

  # Security
  podSecurityContext:
    runAsNonRoot: true
    runAsUser: 1000
    fsGroup: 1000

  containerSecurityContext:
    allowPrivilegeEscalation: false
    capabilities:
      drop:
        - ALL

  # GPU support (used in medium/large profiles)
  gpu:
    enabled: false
    count: 0

# ─── Infrastructure (Minimal) ────────────────────────────
postgresql:
  enabled: true
  encryption:
    enabled: false
  auth:
    username: odg
    password: dev_password_change_me
    database: odg
  primary:
    resources:
      requests:
        cpu: 250m
        memory: 512Mi
      limits:
        cpu: 500m
        memory: 1Gi
    persistence:
      enabled: true
      size: 8Gi

redis:
  enabled: true
  auth:
    enabled: true
    password: dev_redis_password
  master:
    resources:
      requests:
        cpu: 100m
        memory: 128Mi
      limits:
        cpu: 200m
        memory: 256Mi
    persistence:
      enabled: false

minio:
  enabled: true
  auth:
    rootUser: admin
    rootPassword: dev_minio_password
  resources:
    requests:
      cpu: 250m
      memory: 256Mi
    limits:
      cpu: 500m
      memory: 512Mi
  persistence:
    enabled: true
    size: 10Gi

# ─── Messaging (NATS only for embedded) ─────────────────
nats:
  enabled: true
  resources:
    requests:
      cpu: 100m
      memory: 128Mi
    limits:
      cpu: 200m
      memory: 256Mi

kafka:
  enabled: false  # Too heavy for embedded

# ─── Layer 5: Analytics & Query (Disabled) ──────────────
trino:
  enabled: false

airflow:
  enabled: false

superset:
  enabled: false

timescaledb:
  enabled: false

# ─── AI Components (Disabled) ───────────────────────────
qdrant:
  enabled: false

kubeflow:
  enabled: false

# ─── Data Catalog (Disabled) ────────────────────────────
datahub:
  enabled: false

# ─── Observability (Minimal - Jaeger only) ──────────────
grafana:
  enabled: false

loki:
  enabled: false

tempo:
  enabled: true
  resources:
    requests:
      cpu: 100m
      memory: 128Mi
    limits:
      cpu: 200m
      memory: 256Mi

# ─── Auth & Security (Disabled) ─────────────────────────
certManager:
  enabled: false

keycloak:
  enabled: false

opa:
  enabled: false

vault:
  enabled: false

istio:
  enabled: false

networkPolicies:
  enabled: false

# ─── Custom Services (OpenDataGov Core) ─────────────────
governance-engine:
  enabled: true
  replicaCount: 1
  image:
    repository: opendatagov/governance-engine
    tag: "0.1.0"
    pullPolicy: IfNotPresent

  resources:
    requests:
      cpu: 500m
      memory: 512Mi
    limits:
      cpu: "1"
      memory: 1Gi

  service:
    type: ClusterIP
    port: 8000
    grpcPort: 50051

  env:
    ENVIRONMENT: embedded
    LOG_LEVEL: INFO
    ENABLE_GRPC: "true"
    ENABLE_GRAPHQL: "true"

  autoscaling:
    enabled: false

lakehouse-agent:
  enabled: true
  replicaCount: 1
  image:
    repository: opendatagov/lakehouse-agent
    tag: "0.1.0"
    pullPolicy: IfNotPresent

  resources:
    requests:
      cpu: 500m
      memory: 512Mi
    limits:
      cpu: "1"
      memory: 1Gi

  service:
    type: ClusterIP
    port: 8001

  env:
    ENVIRONMENT: embedded
    LOG_LEVEL: INFO

  autoscaling:
    enabled: false

data-expert:
  enabled: false  # Disabled in embedded

dataExpert:
  allowExternalAI: false

quality-gate:
  enabled: false  # Disabled in embedded

gateway:
  enabled: false  # Disabled in embedded

# ─── Spark (Disabled) ───────────────────────────────────
spark:
  enabled: false

# ─── Ingress ────────────────────────────────────────────
ingress:
  enabled: false
  className: nginx
  annotations: {}
  tls: []

# ─── Service Monitor (Prometheus) ───────────────────────
serviceMonitor:
  enabled: false

# ─── Pod Security Standards ────────────────────────────
podSecurity:
  enabled: false  # Disabled for embedded
  enforce: privileged
